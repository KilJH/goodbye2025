// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

// 사용자 모델 - 이름으로 접근 권한 획득
model User {
  id        String   @id @default(cuid())
  name      String   @unique
  createdAt DateTime @default(now())

  recommendations FoodRecommendation[]
  votes           FoodVote[]
}

// 음식 추천 모델
model FoodRecommendation {
  id        String   @id @default(cuid())
  foodName  String
  tags      String[] // AI가 생성한 태그들
  userId    String
  user      User     @relation(fields: [userId], references: [id])
  createdAt DateTime @default(now())

  @@index([foodName])
}

// 음식 좋아요/싫어요 투표 모델
model FoodVote {
  id        String   @id @default(cuid())
  foodName  String   // 음식 이름 (그룹화된 대표 이름)
  voteType  String   // "like" 또는 "dislike"
  userId    String
  user      User     @relation(fields: [userId], references: [id])
  createdAt DateTime @default(now())

  @@unique([foodName, userId]) // 한 사용자가 한 음식에 한 번만 투표
  @@index([foodName])
}

// 제비뽑기 결과 모델
model LotteryResult {
  id          String   @id @default(cuid())
  foodName    String
  rank        Int
  voteCount   Int
  probability Float
  createdAt   DateTime @default(now())
}
